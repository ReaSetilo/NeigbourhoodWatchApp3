import{p as s,w as O,v as C,a as u}from"./chunk-NISHYRIK-bW9Td-MD.js";import{H as N}from"./Header-1hr30dbd.js";import"./utils-B6NI4t93.js";const g=({headerTitle:n,total:i,suspended:e,admins:m,members:h,officers:o,Otp:c,twoFA:p,todayScans:j,alerts:r,missed:l,uniqueOfficers:f,uniqueLocations:d,active:y,revenue:a})=>s.jsxs("article",{className:"stats-card",children:[s.jsx("h3",{className:"text-lg font-semibold text-dark-200 mb-4",children:n}),s.jsxs("div",{className:"flex flex-col gap-2",children:[i!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Total:"}),s.jsx("span",{className:"font-medium text-dark-200",children:i})]}),e!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Suspended:"}),s.jsx("span",{className:"font-medium text-red-500",children:e})]}),m!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Admins:"}),s.jsx("span",{className:"font-medium text-dark-200",children:m})]}),h!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Members:"}),s.jsx("span",{className:"font-medium text-dark-200",children:h})]}),o!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Officers:"}),s.jsx("span",{className:"font-medium text-dark-200",children:o})]}),c!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"OTP Sent:"}),s.jsx("span",{className:"font-medium text-dark-200",children:c})]}),p!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"2FA Failures:"}),s.jsx("span",{className:"font-medium text-red-500",children:p})]}),j!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Today's Scans:"}),s.jsx("span",{className:"font-medium text-blue-600",children:j})]}),r!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Alerts:"}),s.jsx("span",{className:"font-medium text-orange-500",children:r})]}),l!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Missed Patrols:"}),s.jsx("span",{className:"font-medium text-red-500",children:l})]}),f!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Active Officers:"}),s.jsx("span",{className:"font-medium text-green-600",children:f})]}),d!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Locations Patrolled:"}),s.jsx("span",{className:"font-medium text-dark-200",children:d})]}),y!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Active:"}),s.jsx("span",{className:"font-medium text-green-600",children:y})]}),a!==void 0&&s.jsxs("div",{className:"stat-item",children:[s.jsx("span",{className:"text-gray-600",children:"Revenue: P"}),s.jsx("span",{className:"font-medium text-green-600",children:a.toLocaleString()})]})]})]}),H=()=>{const n=C(),i={name:"Reatile"},[e,m]=u.useState({monitoredHouses:{total:0,suspended:0},UserOverview:{Admins:0,Members:0,officers:0,total:0},patrolSummary:{todayScans:0,alerts:0,missed:0,totalScans:0,uniqueOfficers:0,uniqueLocations:0}}),[h,o]=u.useState(!0),[c,p]=u.useState(null);return u.useEffect(()=>{(async()=>{try{o(!0);const l=await(await fetch("http://localhost:3000/api/admin/houses",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),d=await(await fetch("http://localhost:3000/api/admin/users",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),a=await(await fetch("http://localhost:3000/api/admin/patrolStats?period=day",{method:"GET",headers:{"Content-Type":"application/json"}})).json(),S=await(await fetch("http://localhost:3000/api/admin/patrolStats?period=month",{method:"GET",headers:{"Content-Type":"application/json"}})).json();if(l.success&&d.success){const b=l.data,x=d.data,T=b.length,k=b.filter(t=>t.status==="suspended").length,_=x.filter(t=>t.user_type==="admin").length,D=x.filter(t=>t.user_type==="neighborhood_member").length,E=x.filter(t=>t.user_type==="security_officer").length,v=a.success?a.data.summary:null,w=a.success?a.data.anomaly_statistics:null,R=S.success?S.data.summary:null;m({monitoredHouses:{total:T,suspended:k},UserOverview:{Admins:_,Members:D,officers:E,total:x.length},patrolSummary:{todayScans:v?.total_scans||0,alerts:w?.total||0,missed:w?.by_type?.missed_patrol||0,totalScans:R?.total_scans||0,uniqueOfficers:v?.unique_officers||0,uniqueLocations:v?.unique_locations||0}})}else throw new Error("Failed to fetch dashboard data")}catch(r){p(r.message),console.error("Error fetching dashboard data:",r)}finally{o(!1)}})()},[]),h?s.jsxs("main",{className:"dashboard wrapper",children:[s.jsx(N,{title:"WelcomeðŸ‘‹",description:"Track activity and manage the system"}),s.jsx("div",{className:"flex-center p-8",children:s.jsx("p",{className:"p-18-regular text-gray-500",children:"Loading dashboard..."})})]}):c?s.jsxs("main",{className:"dashboard wrapper",children:[s.jsx(N,{title:`Welcome ${i.name} ðŸ‘‹`,description:"Track activity and manage the system"}),s.jsx("div",{className:"error p-4",children:s.jsxs("p",{children:["Error: ",c]})})]}):s.jsxs("main",{className:"dashboard wrapper",children:[s.jsx(N,{title:`Welcome ${i.name} ðŸ‘‹`,description:"Track activity and manage the system"}),s.jsx("section",{className:"flex flex-col gap-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 w-full",children:[s.jsx("div",{onClick:()=>n("/houses"),className:"cursor-pointer hover:opacity-80 transition-opacity",children:s.jsx(g,{headerTitle:"Monitored Houses",total:e.monitoredHouses.total,suspended:e.monitoredHouses.suspended})}),s.jsx("div",{onClick:()=>n("/all-users"),className:"cursor-pointer hover:opacity-80 transition-opacity",children:s.jsx(g,{headerTitle:"User overview",admins:e.UserOverview.Admins,members:e.UserOverview.Members,officers:e.UserOverview.officers})}),s.jsx("div",{onClick:()=>n("/patrol-stats"),className:"cursor-pointer hover:opacity-80 transition-opacity",children:s.jsx(g,{headerTitle:"Patrol Summary (Today)",todayScans:e.patrolSummary.todayScans,alerts:e.patrolSummary.alerts,missed:e.patrolSummary.missed,uniqueOfficers:e.patrolSummary.uniqueOfficers,uniqueLocations:e.patrolSummary.uniqueLocations})})]})})]})},P=O(H);export{P as default};

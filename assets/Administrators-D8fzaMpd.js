import{w as F,a,p as e}from"./chunk-NISHYRIK-bW9Td-MD.js";import{H as p}from"./Header-1hr30dbd.js";import{G as D,C as L,a as n,P as q,S as I,F as M}from"./grid.component-C3KD7pf_.js";import{I as O}from"./template-B_1vptV0.js";import"./utils-B6NI4t93.js";import"./sanitize-helper-CTTLmxlq.js";import"./button-qKIcIH9O.js";import"./index-kCI-pDpd.js";const z=()=>{const[f,_]=a.useState([]),[v,h]=a.useState(!0),[g,C]=a.useState(null),[S,m]=a.useState(!1),[l,y]=a.useState(!1),[b,d]=a.useState(null),[j,c]=a.useState(null),[s,x]=a.useState({first_name:"",last_name:"",email:"",phone_number:"",password:"",confirmPassword:"",can_modify_system_config:!1});a.useEffect(()=>{w()},[]);const w=async()=>{try{h(!0);const r=await fetch("http://localhost:3000/api/admin/users",{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error("Failed to fetch users");const t=await r.json();if(t.success){const o=t.data.filter(u=>u.user_type==="admin");_(o)}else throw new Error(t.message||"Failed to fetch users")}catch(r){C(r.message),console.error("Error fetching users:",r)}finally{h(!1)}},i=r=>{const{name:t,value:o,type:u,checked:T}=r.target;x(A=>({...A,[t]:u==="checkbox"?T:o}))},P=async r=>{if(r.preventDefault(),d(null),c(null),s.password!==s.confirmPassword){d("Passwords do not match");return}if(s.password.length<8){d("Password must be at least 8 characters long");return}try{y(!0);const t=await fetch("http://localhost:3000/api/admin/administrators",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:s.first_name,last_name:s.last_name,email:s.email,phone_number:s.phone_number,password:s.password,can_modify_system_config:s.can_modify_system_config})}),o=await t.json();if(!t.ok)throw new Error(o.message||"Failed to create admin");if(o.success)c("Administrator created successfully!"),x({first_name:"",last_name:"",email:"",phone_number:"",password:"",confirmPassword:"",can_modify_system_config:!1}),w(),setTimeout(()=>{m(!1),c(null)},2e3);else throw new Error(o.message||"Failed to create admin")}catch(t){d(t.message),console.error("Error creating admin:",t)}finally{y(!1)}},N=()=>{m(!1),d(null),c(null),x({first_name:"",last_name:"",email:"",phone_number:"",password:"",confirmPassword:"",can_modify_system_config:!1})},k=r=>{const t={active:"bg-success-50 text-success-700",suspended:"bg-red-50 text-red-500",inactive:"bg-gray-200 text-gray-700",deleted:"bg-red-100 text-red-500"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t[r.status]||"bg-gray-200 text-gray-700"}`,children:r.status})},E=r=>e.jsx("div",{className:"flex-center",children:r.is_approved?e.jsx("span",{className:"text-success-500 text-lg font-semibold",children:"✓"}):e.jsx("span",{className:"text-red-500 text-lg font-semibold",children:"✗"})});return v?e.jsxs("main",{className:"dashboard wrapper",children:[e.jsx(p,{title:"Administrators",description:"View and manage administrator accounts"}),e.jsx("div",{className:"flex-center p-8",children:e.jsx("p",{className:"p-18-regular text-gray-500",children:"Loading administrators..."})})]}):g?e.jsxs("main",{className:"dashboard wrapper",children:[e.jsx(p,{title:"Administrators",description:"View and manage administrator accounts"}),e.jsx("div",{className:"error p-4",children:e.jsxs("p",{children:["Error: ",g]})})]}):e.jsxs("main",{className:"administrators wrapper",children:[e.jsx(p,{title:"Administrators",description:"View and manage administrator accounts"}),e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"flex-between mb-6",children:[e.jsx("h1",{className:"p-24-semibold text-dark-100",children:"Administrators"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"p-16-semibold text-gray-500",children:["Total: ",f.length]}),e.jsxs("button",{onClick:()=>m(!0),className:"bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg font-semibold transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"+"})," Add"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-300 p-6",children:e.jsxs(D,{dataSource:f,allowPaging:!0,allowSorting:!0,allowFiltering:!0,pageSettings:{pageSize:10,pageSizes:[10,25,50,100]},filterSettings:{type:"Excel"},width:"100%",children:[e.jsxs(L,{children:[e.jsx(n,{field:"user_id",headerText:"ID",width:"80",isPrimaryKey:!0,textAlign:"Center",visible:!0}),e.jsx(n,{field:"first_name",headerText:"First Name",width:"140"}),e.jsx(n,{field:"last_name",headerText:"Last Name",width:"140"}),e.jsx(n,{field:"email",headerText:"Email",width:"220"}),e.jsx(n,{field:"phone_number",headerText:"Phone",width:"140"}),e.jsx(n,{field:"status",headerText:"Status",width:"130",template:k}),e.jsx(n,{field:"is_approved",headerText:"Approved",width:"110",template:E,textAlign:"Center"}),e.jsx(n,{field:"last_login",headerText:"Last Login",width:"140",format:"yMd",type:"date"}),e.jsx(n,{field:"created_at",headerText:"Joined Date",width:"140",format:"yMd",type:"date"})]}),e.jsx(O,{services:[q,I,M]})]})})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Add New Administrator"}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-600 text-2xl",disabled:l,children:"×"})]})}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-4",children:[b&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:b}),j&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:j}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"first_name",value:s.first_name,onChange:i,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"last_name",value:s.last_name,onChange:i,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:i,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"phone_number",value:s.phone_number,onChange:i,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",name:"password",value:s.password,onChange:i,required:!0,minLength:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 8 characters"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Confirm Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",name:"confirmPassword",value:s.confirmPassword,onChange:i,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"can_modify_system_config",id:"can_modify_system_config",checked:s.can_modify_system_config,onChange:i,className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("label",{htmlFor:"can_modify_system_config",className:"ml-2 text-sm text-gray-700",children:"Can modify system configuration"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:N,disabled:l,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"flex-1 px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Creating...":"Create Admin"})]})]})]})})]})},B=F(z);export{B as default};
